// Copyright 2012-2013 UIEvolution Inc. All Rights Reserved.
(function(){var F=[].slice,G=window,c=function(){var h,g,d,p,l;this.__hooks={};l="getSongMetadata setPlaybackMode getPlaybackStatus play pause stop skip setPosition getPlaylist getGenres getArtists getAlbums getMusicTracks getAlbumArtwork enableFilter disableFilter ioctlFilter".split(" ");var k=this;g=function(d){return k[d]=function(){var a,b,h,e,f,g,j,l,p,q,r,s,t,u,v,w,x,y,z,A,B,C;b=1<=arguments.length?F.call(arguments,0):[];h=b[0];b[0]instanceof Function&&(k.__hooks[d]=b[0]);e=k._host&&k._port?
"":d+"|";a=e+"format=xml&";switch(d){case "getSongMetadata":a+="cmd=metadata&title="+(null!=(l=b[1])?l:c.METADATA_CURRENT);break;case "setPlaybackMode":a+=["cmd=playbackmode&repeat=",b[1],"&shuffle=",b[2]].join("");break;case "getPlaybackStatus":a+="cmd=playbackstatus";break;case "play":a+="cmd=play";null!=b[1]&&(a+="&title="+b[1]);break;case "pause":a+="cmd=pause";break;case "stop":a+="cmd=stop";break;case "skip":a+="cmd="+b[1];break;case "setPosition":a+=["cmd=setpos&pos=",b[1]].join("");break;
case "getPlaylist":e=null!=(v=b[1])?v:m;f=null!=(w=b[2])?w:n;a+=["cmd=ls&category=playlist&count=",e,"&offset=",f].join("");break;case "getGenres":e=null!=(x=b[1])?x:m;f=null!=(y=b[2])?y:n;a+=["cmd=ls&category=genre&count=",e,"&offset=",f].join("");break;case "getArtists":e=null!=(z=b[1])?z:m;f=null!=(A=b[2])?A:n;b=null!=(B=b[3])?B:{};a+=["cmd=ls&category=artist&count=",e,"&offset=",f].join("");null!=b.genre_id&&(a+=[a,"&genre="+b.genre_id].join(""));break;case "getAlbums":e=null!=(C=b[1])?C:m;f=
null!=(p=b[2])?p:n;b=null!=(g=b[3])?g:{};a=[a,"cmd=ls&category=album&count=",e,"&offset=",f].join("");null!=b.artist_id&&(a=[a,"&artist="+b.artist_id].join(""));null!=b.genre_id&&(a=[a,"&genre="+b.genre_id].join(""));break;case "getMusicTracks":e=null!=(q=b[1])?q:m;f=null!=(r=b[2])?r:n;b=null!=(s=b[3])?s:{};a+=["cmd=ls&category=title&count=",e,"&offset=",f].join("");b.artist_id&&(a=[a,"&artist="+b.artist_id].join(""));b.genre_id&&(a=[a,"&genre="+b.genre_id].join(""));b.playlist_id&&(a=[a,"&playlist="+
b.playlist_id].join(""));b.album_id&&(a=[a,"&album="+b.album_id].join(""));b.music_id&&(a=[a,"&title="+b.music_id].join(""));break;case "getAlbumArtwork":a=null!=(t=b[1])?t:0;g=null!=(u=b[2])?u:D;b=null!=(f=b[3])?f:E;a=e+["cmd=artwork&album=",a,"&w=",g,"&h=",b,"&format=pngbase64"].join("");break;case "enableFilter":a+="cmd=enablefilter";break;case "disableFilter":a+="cmd=disablefilter";break;case "ioctlFilter":a+="cmd=ioctlfilter&id=1";null!=b[1]&&(a+="&param1="+b[1]);null!=b[2]&&(a+="&param2="+b[2]);
break;default:return}return k._host&&k._port?(j=new XMLHttpRequest,j.open("POST",["http://",k._host,":",k._port,"/localplayback/?",+new Date].join(""),!0),j.onreadystatechange=function(){var a;if(4===j.readyState)return 200===j.status?h instanceof Function&&h(j.responseText):(a="<Result><Command>"+d+"</Command><ResponseCode>-1</ResponseCode></Result>",h(a)),j.abort(),j.onreadystatechange=function(){return{}}},j.send(a)):document.location=["UJMLAPP:LP(",a,")"].join("")}};d=0;for(p=l.length;d<p;d++)h=
l[d],g(h)},E,D,m,n;c.METADATA_CURRENT="current";c.REPEAT_OFF="off";c.REPEAT_ONE="one";c.REPEAT_ALL="all";c.SHUFFLE_ON="on";c.SHUFFLE_OFF="off";c.SKIP_TO_NEXT_ALBUM="albumnext";c.SKIP_TO_PREV_ALBUM="albumprev";c.SKIP_TO_NEXT_TRACK="skiptonext";c.SKIP_TO_PREV_TRACK="skiptoprev";c.__instance=null;c.deferred_return=function(h,g){var d;d=c.getInstance();if(null!=d&&(d=d.__hooks[h],null!=d))return d(g)};c.getInstance=function(){null==c.__instance&&(c.__instance=new c);return c.__instance};c.version="2.0.0";
n=0;m=30;E=D=256;c.prototype.useXHR=function(c,g){this._host=c;return this._port=g};c.prototype.isUseXHR=function(){return this._host&&this._port};G.UIELocalPlayback=c}).call(this);
